---
title: "Introductie: Waarom Statistiek?"
author: Lieven Clement
output: ioslides_presentation
---


## Oksel microbiome voorbeeld

![](https://images.vrt.be/width1280/2018/06/27/4e72098d-7a0d-11e8-abcc-02b7b76bf47f.jpg){width=70%}

- https://www.vrt.be/vrtnws/nl/2018/10/22/gezocht-mensen-met-penetrante-lijfgeur-om-probiotische-deodor/
- https://youtu.be/9RIFyqLXdVw

```{r echo=FALSE}
library(tidyverse)
```

---

- *Corynebacterium spp.* metaboliseren zweet en produceren verzadigde vetzuren met een penetrante geur.

- *Staphylococcus spp.* metaboliseren zweet ook maar produceren geen hinderlijke vetzuren.

- De CMET-groep aan UGENT doet onderzoek naar het transplanteren van de microbiële gemeenschap, het microbiome, om mensen van geurende oksels af te helpen.

- Voorgestelde therapie

  	1. Verwijder het oksel microbiome met antibiotica
    2. Beïnvloed het oksel microbiome door microbiome te transplanteren van een individue die geen geurende oksels heeft

---

- Experiment:

    - 20 personen met okselgeur worden at random in twee behandelingsgroepen ingedeeld:

        - placebo (enkel antibiotica)
        - transplantie (antibiotica en microbiële transplantatie).

    - Het microbiome wordt bemonsterd 6 weken na de behandeling.
    - The relative abundantie van *Staphylococcus spp.* op *Corynebacterium spp.* + *Staphylococcus spp.* in het microbiome wordt gemeten via DGGE (*Denaturing Gradient Gel Electrophoresis*).



## Importeer de data

```{r}
read_lines("https://raw.githubusercontent.com/statOmics/sbc20/master/data/armpit.csv")
```

---

```{r}
ap <- read_csv("https://raw.githubusercontent.com/statOmics/sbc20/master/data/armpit.csv")
```

---

```{r}
ap
```


## Data Exploratie and beschrijvende Statistiek

- Data exploratie is heel belangrijk om inzicht te krijgen in de data en is een essentiële eerste stap om te leren uit data.

- Het wordt vaak ondergewaardeerd of over het hoofd gezien.

---

### Beschrijvende statistiek

```{r echo=FALSE}
apRelSum <- ap %>%
  group_by(trt) %>%
  summarize_at("rel",
               list(mean=mean,
                    sd=sd
                    )
                )
knitr::kable(
  apRelSum %>%
  mutate_if(is.numeric, round, digits=1)
  )
```


---

#### Barplot

```{r echo=FALSE}
apRelSum%>%
  ggplot(aes(x=trt,y=mean)) +
  geom_bar(stat="identity") +
  geom_errorbar(aes(ymin=mean-sd,ymax=mean+sd),width=.2)
```

- Is deze plot informatief??

---

#### Boxplot

```{r echo=FALSE}
ap %>%  
  ggplot(aes(x=trt,y=rel)) +
  geom_boxplot()
```

---


```{r echo=FALSE}
ap %>%  
  ggplot(aes(x=trt,y=rel)) +
  geom_boxplot(outlier.shape=NA) +
  geom_point(position="jitter")
```

Dit is een informatieve plot!


## Enkele concepten

- Waarom hebben we meer dan 1 subject nodig per groep?

- Wat wordt er bedoelt met de term random en wat zijn de consequenties hiervan?


- Beschouw twee proefopzetten:

1. Een onderzoeker selecteert at random 20 mannelijke studenten die last hebben van okselgeur van de faculteit.

2. Een onderzoeker selecteert at random 20 personen die last hebben van okselgeur van de Belgische populatie.

---

Random steekproef van faculteit

```{r echo=FALSE}
ap %>%  
  ggplot(aes(x=trt,y=rel)) +
  geom_boxplot(outlier.shape=NA) +
  geom_point(position="jitter") +
  ylim(0,100)

```

---

Random steekproef van Belgische populatie

```{r echo=FALSE,warning=FALSE}
ap2<-ap
hlp<-lm(rel~trt,ap)
ap2$rel<-rnorm(20,mean=hlp$fit-20,sd=sigma(hlp)*2)

ap2 %>%  
  ggplot(aes(x=trt,y=rel)) +
  geom_boxplot(outlier.shape=NA) +
  geom_point(position="jitter") +
  ylim(0,100)
```

Wat is nu het beste experiment?

---


- Randomisatie sterk gerelateerd met het concept van de populatie en scope van de studie.  

- Op basis van de steekproef kunnen de onderzoekers conclusies trekken over

    - Mannelijke studenten in de faculteit
    - Mensen van de Belgische populatie

- De scope van de studie moet goed worden omschreven voor de start van het experiment.

- Om resultaten van de steekproef te kunnen veralgemenen naar de populatie toe  $\rightarrow$ trek subjecten at random van de populatie

---

- Volledig random trekken van de populatie :

    - alle subjecten van de populatie hebben evenveel kans om in de steekproef te worden opgenomen
    - selectie van een subject is onafhankelijk van andere subjecten in de steekproef.


- De steekproef is dan representatief voor de populatie, maar is nog steeds random.

- Wat betekent dit?

---



- Om te begrijpen dat een steekproef random is zouden we hetzelfde experiment veel keer moeten kunnen herhalen (`repeated sampling`).

- Dan zouden we inzicht kunnen krijgen hoe de gegevens veranderen van steekproef tot steekproef.

- Of wat met andere woorden de variabiliteit is van steekproef tot steekproef.

---


## Variabiliteit van steekproef tot steekproef

- Om dit te illustreren zullen we gebruik maken van een hele grote studie.

- Uit die studie zullen we herhaaldelijk kleine steekproeven trekken om te begrijpen hoe de gegevens en statistieken veranderen van steekproef tot steekproef.

---


```{r}
library(NHANES)
NHANES
```

---

```{r}
glimpse(NHANES)
```

---

Onderzoeksvraag: hoe verschilt het directe cholestorol concentratie tussen mannen en vrouwen ouder dan 25 jaar

```{r echo=FALSE, warning=FALSE, message=FALSE}
NHANES%>%  
  filter(Age>25&!is.na(DirectChol)) %>%
  ggplot(aes(x=DirectChol))+
  geom_histogram() +
  facet_grid(Gender~.) +
  xlab("Direct cholesterol (mg/dl)")
```

---

- Concentratie metingen zijn vaak scheef verdeeld.
- Concentraties kunnen niet lager zijn dan 0.  
- Ze worden dikwijls log getransformeerd.

```{r echo=FALSE, warning=FALSE, message=FALSE}
normalFreq <- NHANES%>%  
  filter(Age>25&!is.na(DirectChol)) %>%
  mutate(cholLog=log2(DirectChol)) %>%
  group_by(Gender) %>%
  group_modify(~tibble(
    x =   seq(
        min(.x$cholLog),
        max(.x$cholLog),
        length=100),
    freq=dnorm(
      seq(
        min(.x$cholLog),
        max(.x$cholLog),
        length=100),
      mean=mean(.x$cholLog),
      sd=sd(.x$cholLog))*nrow(.x)
      )
      ,keep=TRUE)
binwidth <- .1
NHANES %>%  
  filter(Age>25&!is.na(DirectChol)) %>%
  mutate(cholLog=log2(DirectChol)) %>%
  ggplot(aes(x=DirectChol %>% log2)) +
  geom_histogram(binwidth=binwidth) +
  facet_grid(Gender~.) +
  geom_line(data=normalFreq,aes(x=x,y=freq*binwidth)) +
  xlab("Direct cholesterol (log2)")
```

---

- Approximatief Normaal verdeeld na log transformatie
- De normale verdeling heeft maar 2 parameters: het gemiddelde en de variantie (maat voor spreiding).
- Laat toe om de data verder samen te vatten d.m.v. twee statistieken:

    - gemiddelde
    - standaard deviatie

---

```{r echo=FALSE}
nhanesSub<- NHANES%>%
  filter(Age>25&!is.na(DirectChol)) %>%
  select(c("Gender","DirectChol")) %>%
  mutate(cholLog=log2(DirectChol))

cholLogSum <- nhanesSub %>%
  group_by(Gender) %>%
  summarize_at("cholLog",
               list(mean=mean,
               sd=sd)
              )

knitr::kable(
  cholLogSum %>%
  mutate_if(is.numeric, round, digits=1)
  )
```


- Heel grote studie

    - Schattingen heel nauwkeurig
    - populatiegemiddelde en standaardafwijking op log schaal kunnen we min of meer als gekend veronderstellen.



---


- Stel dat we geen toegang hebben tot de cholestorol metingen van de NHANES studie.

- We zouden dan een experiment op moeten zetten om cholestorol metingen bij mannen en vrouwen te doen.

- Veronderstel dat we budget hebben om metingen bij 10 mannen en 10 vrouwen te doen.

- We zouden dan 10 mannen en 10 vrouwen boven de 25 jaar at random selecteren uit de Amerikaanse populatie.

- We kunnen dit experiment simuleren door 10 vrouwen en 10 mannen at random te selecteren uit de NHANES studie.

---

```{r echo=FALSE}
set.seed(134)

fem <- nhanesSub %>%
  filter(Gender=="female") %>%
  sample_n(size=10)

mal <- nhanesSub %>%
  filter(Gender=="male") %>%
  sample_n(size=10)

samp <- rbind(fem,mal)
```

```{r}
samp
```

---

Data Exploratie

```{r echo=FALSE,warning=FALSE,message=FALSE}
samp %>%
  ggplot(aes(x=cholLog)) +
  geom_histogram(binwidth = .1) +
  facet_grid(Gender~.) +
  xlab("Direct cholesterol (log2)")

  cholLogSumExp1 <- samp %>%
     group_by(Gender) %>%
     summarize_at("cholLog",
                 list(mean=mean,
                      sd=sd)
                  )
```

Histogram is niet zinvol als we maar zo weinig datapunten hebben.

---

Boxplot is beter:

```{r echo=FALSE}
samp %>%
  ggplot(aes(x=Gender,y=cholLog)) +
  geom_boxplot(outlier.shape=NA) +
  geom_point(position="jitter") +
#  geom_point(aes(x=1:2,y=c(mean(fem$cholLog),mean(mal$cholLog))),size=3,pch=17) +
  ylab("Cholestorol concentratie (log2)")
```

log cholestorol concentratie gemiddeld `r round(abs(cholLogSumExp1$mean[1]-cholLogSumExp1$mean[2]),2)` eenheden `r ifelse(cholLogSumExp1$mean[1]>cholLogSumExp1$mean[2],"hoger","lager")` bij vrouwen dan bij mannen. En dit verschil is statistisch `r ifelse(t.test(cholLog~Gender,samp,var.equal=TRUE)$p.value < 0.05,"significant","niet significant")`

---

Herhaal experiment: Nieuwe steekproef

```{r echo=FALSE}
fem <- nhanesSub %>%
  filter(Gender=="female") %>%
  sample_n(size=10)

mal <- nhanesSub %>%
  filter(Gender=="male") %>%
  sample_n(size=10)

samp2 <- rbind(fem,mal)

samp2 %>%
  ggplot(aes(x=Gender,y=cholLog)) +
  geom_boxplot(outlier.shape=NA) +
  geom_point(position="jitter") +
#  geom_point(aes(x=1:2,y=c(mean(fem$cholLog),mean(mal$cholLog)),color="Pop. Verschil"),size=3,pch=17) +
  ylab("Cholestorol concentratie (log2)")

  cholLogSumExp2 <- samp2 %>%
     group_by(Gender) %>%
     summarize_at("cholLog",
                 list(mean=mean,
                      sd=sd)
                  )
```


log cholestorol concentratie gemiddeld `r round(abs(cholLogSumExp2$mean[1]-cholLogSumExp2$mean[2]),2)` eenheden `r ifelse(cholLogSumExp2$mean[1]>cholLogSumExp2$mean[2],"hoger","lager")` bij vrouwen dan bij mannen. En dit verschil is statistisch `r ifelse(t.test(cholLog~Gender,samp2,var.equal=TRUE)$p.value < 0.05,"significant","niet significant")`

---

Herhaal experiment: Nieuwe steekproef

```{r echo=FALSE}
set.seed(12857)
fem <- nhanesSub%>%filter(Gender=="female")%>%sample_n(size=10)
mal <- nhanesSub%>%filter(Gender=="male")%>%sample_n(size=10)

samp3<-rbind(fem,mal)

samp3%>%
  ggplot(aes(x=Gender,y=cholLog)) +
  geom_boxplot(outlier.shape=NA) +
  geom_point(position="jitter") +
#  geom_point(aes(x=1:2,y=c(mean(fem$cholLog),mean(mal$cholLog)),color="Pop. Verschil"),size=3,pch=17) +
  ylab("Cholestorol concentratie (log2)")

cholLogSumExp3 <- samp3 %>%
  group_by(Gender) %>%
  summarize_at("cholLog",
                   list(mean=mean,
                        sd=sd)
                    )
```


log cholestorol concentratie gemiddeld `r round(abs(cholLogSumExp3$mean[1]-cholLogSumExp3$mean[2]),2)` eenheden `r ifelse(cholLogSumExp3$mean[1]>cholLogSumExp3$mean[2],"hoger","lager")` bij vrouwen dan bij mannen. En dit verschil is statistisch `r ifelse(t.test(cholLog~Gender,samp3,var.equal=TRUE)$p.value < 0.05,"significant","niet significant")`

---

## Samenvatting

- At random andere proefpersonen in elke steekproef

- Hierdoor verschillen cholestorol metingen van steekproef tot steekproef alsook geschatte gemiddelden en de standaard deviaties.

- Ook onze conclusies zijn onzeker en kunnen wijzigen van steekproef tot steekproef.

- Steekproeven waarbij effect omkeert en waarbij we besluiten dat het verschil significant is zijn zeldzaam
$\rightarrow$ Met statistiek controleren we net de kans op het trekken foute conclusies.

---

## We illusteren dit door het experiment heel veel keer uit te voeren

- We trekken 20000 herhaalde steekproeven van 10 vrouwen en 10 mannen uit de NHANES studie.

```{r echo=FALSE}
# Aantal simulaties en steekproefgrootte per groep
nSim <- 20000
nSamp <- 10

# We filteren de data vooraf zodat we dit niet telkens opnieuw hoeven te doen
fem<-nhanesSub %>%
  filter(Gender=="female")

mal <- nhanesSub %>%
  filter(Gender=="male")

# Simulatie studie
# Om snelle functies te kunnen gebruiken nemen we eerst nSim steekproeven en berekenen we daarna alles.

femSamps <- malSamps <-matrix(NA,nrow=nSamp,ncol=nSim)
for (i in 1:nSim)
{
  femSamps[,i] <- sample(fem$cholLog,nSamp)
  malSamps[,i] <- sample(mal$cholLog,nSamp)
}

res <- data.frame(
  verschil=colMeans(femSamps) - rowMeans(malSamps),
  Rfast::ttests(femSamps,malSamps)
  )
```

- Aantal steekproeven waarvoor het gemiddelde voor vrouwen significant hoger is dan voor mannen: `r sum(res$pvalue<0.05&res$verschil>0)`
- Aantal steekproeven waarvoor het gemiddelde niet significant verschillende is tussen vrouwen en mannen: `r sum(res$pvalue>=0.05)`
- Aantal steekproeven waarvoor het gemiddelde van vrouwen significant lager is dan voor mannen: `r sum(res$pvalue<0.05&res$verschil<0)`

---


```{r echo=FALSE}
res %>%
  ggplot(aes(x=verschil,y=-log10(pvalue),color=pvalue<0.05)) +
  geom_point() +
  xlab("Gemiddeld Verschil (log2)") +
  ylab("Statistische Significantie") +
  geom_vline(aes(xintercept=0)) +
  geom_vline(aes(xintercept=mean(fem$cholLog)-mean(mal$cholLog)),color="darkblue")
```


## Grotere steekproef?

Wat gebeurt er als we de steekproefgrootte verhogen naar 50 observaties per groep?

```{r echo=FALSE}
nSim <- 20000
nSamp <- 50

# We filteren de data vooraf zodat we dit niet telkens opnieuw hoeven te doen
fem<-nhanesSub%>%filter(Gender=="female")
mal<-nhanesSub%>%filter(Gender=="male")

# Simulatie studie
# Om snelle functies te kunnen gebruiken nemen we eerst nSim steekproeven en berekenen we daarna alles.

femSamps <- malSamps <-matrix(NA,nrow=nSamp,ncol=nSim)
for (i in 1:nSim)
{
  femSamps[,i] <- sample(fem$cholLog,nSamp)
  malSamps[,i] <- sample(mal$cholLog,nSamp)
}

res <- data.frame(
  verschil=colMeans(femSamps) - rowMeans(malSamps),
  Rfast::ttests(femSamps,malSamps)
  )
```


- Aantal steekproeven waarvoor het gemiddelde voor vrouwen significant hoger is dan voor mannen: `r sum(res$pvalue<0.05&res$verschil>0)`
- Aantal steekproeven waarvoor het gemiddelde niet significant verschillende is tussen vrouwen en mannen: `r sum(res$pvalue>=0.05)`
- Aantal steekproeven waarvoor het gemiddelde van vrouwen significant lager is dan voor mannen: `r sum(res$pvalue<0.05&res$verschil<0)`

---

```{r echo=FALSE}
res %>%
  ggplot(aes(x=verschil,y=-log10(pvalue),color=pvalue<0.05)) +
  geom_point() +
  xlab("Gemiddeld Verschil (log2)") +
  ylab("Statistische Significantie") +
  geom_vline(aes(xintercept=0)) +
  geom_vline(aes(xintercept=mean(fem$cholLog)-mean(mal$cholLog)),color="darkblue")
```


## Salk Study

- In 1916, brak de eerste grote polio epidemie uit in de USA.
- Begin de jaren 50 ontwikkelde John Salk een vaccin met belovende resultaten in het lab.
- In 1954, heeft de National Foundation
for Infantile Paralysis (NFIP) een grote studie opgezet om de effectiviteit van het Salk vaccin na te gaan.
- Veronderstel dat de NFIP in 1954 een groot aantal kinderen zou hebben gevaccineerd, wat zouden ze dan kunnen besluiten als de polio incidentie in 1954 lager was dan in 1953?


## NFIP Study
### Design

- Grote simultane studie met gevaccineerde kinderen (cases) en ongevaccineerde kinderen (controles).
- In scholen van districten met hoge polio incidentie.
- Cases: kinderen van de tweede graad van het lager onderwijs waarvan de ouders toestemden met vaccinatie.
- Controles: kinderen van de eerste en derde graad.

---

### Data
```{r echo=FALSE}
nfip <- tibble(
  group=c("cases","controls","noConcent"),
  grade=c("g2","g1g3","g2"),
  vaccin=c("yes","no","no"),
  total=c(221998,725173,123605),
  polio=c(54,391,56)
  ) %>%
  mutate(noPolio = total - polio)
knitr::kable(nfip)
```

Vergelijk de polio incidentie?

---

### Data
```{r echo=FALSE}
nfip <- nfip %>%
  mutate(incidencePM = round(nfip$polio/nfip$total*1e6,0))
knitr::kable(nfip)
```

Wat kunnen we concluderen?


## Confounding


```{r,echo=FALSE, fig.align = "center",out.width = '50%'}
plot(c(0,0,1),c(-2,2,0),pch=c("S","V","P"),xaxt="none",yaxt="none",axes=FALSE,xlab="",ylab="",cex=4,ylim=c(-2.2,2.2))
arrows(x0=0.1,x1=.9,y0=1.8,y1=0.1,lwd=4)
arrows(x0=0.1,x1=.9,y0=-1.8,y1=-0.2,lwd=4)
arrows(x0=0,x1=0,y0=-1.4,y1=1.4,lwd=4)
```


- We observeren een lagere polio (P) incidentie voor kinderen bij wie de ouders geen toestemming gaven dan in de controle groep.  

- Toestemming voor vaccinatie (V) is geassocieerd met de socio-economische status (S).

- Kinderen van lagere socio-economische status zijn meer resistent tegen de ziekte.

## Confounding

- De groepen van cases en controles zijn niet vergelijkbaar
    - verschil in leeftijd
    - verschil in socio-economische status en
    - verschil in vatbaarheid voor de ziekte.

## Salk Study

### Design
Een nieuwe studie werd uitgevoerd: dubbel blinde gerandomiseerde studie.

  - Kinderen worden at random toegewezen aan controle of case arm van het experiment nadat de ouders toestemden met vaccinatie.
  - Controle: vaccinatie met placebo
  - Treatment: vaccinatie met vaccine
  - double blinding:
    - ouders en kinderen weten niet of ze werden gevaccineerd of niet
    - medische staf en onderzoekers weten niet of het kind het vaccin of de placebo kreeg

---

### Data

```{r echo=FALSE}
salk <- data.frame(
  group=c("cases","control","noConcent"),
  treatment=c("vaccine","placebo","none"),
  total=c(200745,201229, 338778),polio=c(57,142,157)
  ) %>%
  mutate(
    noPolio = salk$total-salk$polio,
    incidencePM = round(salk$polio/salk$total*1e6,0)
    )
knitr::kable(salk)
```

- We observeren een veel groter effect nu dat cases en controles vergelijkbaar zijn, incidentie van respectievelijk `r salk$incidencePM[1]`  and `r salk$incidencePM[2]` per miljoen.

- De polio incidentie voor kinderen die geen toestemming geven blijft vergelijkbaar  `r nfip$incidencePM[3]` and `r salk$incidencePM[3]` per miljoen respectievelijk in the NFIP and Salk study.


## Wetenschappelijke methode

- Empirische data zijn cruciaal in de wetenschappen.  
- Onderzoek wordt tegenwoordig gedreven door data .

```{r,echo=FALSE, fig.align = "center"}
plot(0,0,col=0,xaxt="none",yaxt="none",axes=FALSE,xlab="",ylab="",cex=4,ylim=c(-.5,1.5),xlim=c(-.5,1.5))
lines(c(0,1),c(0,0),lwd=4)
lines(c(0,.5),c(0,1),lwd=4)
lines(c(.5,1),c(1,0),lwd=4)
text(0.5,1.2,"Nature",cex=2)
text(0.8,.5,"Experiment",cex=2,pos=4,col="darkred")
text(1,0,"Data",cex=2,pos=4)
text(0.2,.5,"Theory",cex=2,pos=2,col="darkred")
text(0,0,"Model",cex=2,pos=2)
text(0.5,-0.3,"Statistical\nInference",cex=2,col="darkred")
```

- *Natuur*: proces die we bestuderen

- *Deductie*: leid logische gevolgen af van een theorie of hypothese die experimenteel kan worden gevalideerd.

- *Experiment*:  verzamel data over het proces. De data zijn een manifestatie van het werkelijk onderliggende proces. Het experiment moet *representatief* en *reproduceerbaar* zijn en moet de theorie/hypothese uitdagen. *Experimenteel Design*!

- *Statistische besluitvorming (inferentie)*: brug om model/hypothese te confronteren met de data: is de *sluitsteen van de wetenschappelijke methode*

- *Falsificatie principe*: Data can niet worden gebruikt om een hypothese te bewijzen, ze kan een hypothese enkel ontkrachten.

- *Data-exploratie en analyse* wordt gebruik om de theorie te verfijnen en om nieuwe hypotheses te genereren.

## Rol van Statistiek
- We hebben gezien dat
    - het belangrijk is om de scope van de studie goed te specifiëren voor de start van het experiment.
    - steekproef grootte is heel belangrijk
    - we moeten ons bewust zijn van Confounding
    - een goede controle is belangrijk


$\rightarrow$ Goede proefopzet is cruciaal!

---

- We hebben ook geobserveerd dat er variabiliteit is in de populatie
- We kunnen maar een steekproef nemen uit de populatie

$\rightarrow$ onzekerheid in de resultaten

$\rightarrow$ onzekerheid in de conclusies


---

- Statistiek is de wetenschap voor het

    1. verzamelen (experimenteel design),
    2. exploren (data exploration) en
    3. leren van data zodat we hetgeen we observeren in de steekproef kunnen veralgemenen naar de populatie terwijl we de onzekerheid quantificeren, controleren en rapporteren (statistisch modelleren en statistische besluitvorming).

- Statistiek speelt daarom een heel belangrijke rol in zowat alle wetenschappen

---

```{r pop2Samp2Pop, out.width='80%',fig.asp=.8, fig.align='center',echo=FALSE}
if ("pi"%in%ls()) rm("pi")
kopvoeter<-function(x,y,angle=0,l=.2,cex.dot=.5,pch=19,col="black")
{
angle=angle/180*pi
points(x,y,cex=cex.dot,pch=pch,col=col)
lines(c(x,x+l*cos(-pi/2+angle)),c(y,y+l*sin(-pi/2+angle)),col=col)
lines(c(x+l/2*cos(-pi/2+angle),x+l/2*cos(-pi/2+angle)+l/4*cos(angle)),c(y+l/2*sin(-pi/2+angle),y+l/2*sin(-pi/2+angle)+l/4*sin(angle)),col=col)
lines(c(x+l/2*cos(-pi/2+angle),x+l/2*cos(-pi/2+angle)+l/4*cos(pi+angle)),c(y+l/2*sin(-pi/2+angle),y+l/2*sin(-pi/2+angle)+l/4*sin(pi+angle)),col=col)
lines(c(x+l*cos(-pi/2+angle),x+l*cos(-pi/2+angle)+l/2*cos(-pi/2+pi/4+angle)),c(y+l*sin(-pi/2+angle),y+l*sin(-pi/2+angle)+l/2*sin(-pi/2+pi/4+angle)),col=col)
lines(c(x+l*cos(-pi/2+angle),x+l*cos(-pi/2+angle)+l/2*cos(-pi/2-pi/4+angle)),c(y+l*sin(-pi/2+angle),y+l*sin(-pi/2+angle)+l/2*sin(-pi/2-pi/4+angle)),col=col)
}

par(mar=c(0,0,0,0),mai=c(0,0,0,0))
plot(0,0,xlab="",ylab="",xlim=c(0,10),ylim=c(0,10),col=0,xaxt="none",yaxt="none",axes=FALSE)
rect(0,6,10,10,border="red",lwd=2)
text(.5,8,"population",srt=90,col="red",cex=2)
symbols (3, 8, circles=1.5, col="red",add=TRUE,fg="red",inches=FALSE,lwd=2)
set.seed(330)
grid=seq(0,1.3,.01)

for (i in 1:50)
{
	angle1=runif(n=1,min=0,max=360)
	angle2=runif(n=1,min=0,max=360)
	radius=sample(grid,prob=grid^2*pi/sum(grid^2*pi),size=1)
	kopvoeter(3+radius*cos(angle1/180*pi),8+radius*sin(angle1/180*pi),angle=angle2)
}
text(7.5,8,"cholesterol in population",col="red",cex=1.2)

rect(0,0,10,4,border="blue",lwd=2)
text(.5,2,"sample",srt=90,col="blue",cex=2)
symbols (3, 2, circles=1.5, col="red",add=TRUE,fg="blue",inches=FALSE,lwd=2)
for (i in 0:2)
	for (j in 0:4)
{

	kopvoeter(2.1+j*(3.9-2.1)/4,1.1+i)
}
text(7.5,2,"cholesterol in sample",col="blue",cex=1.2)

arrows(3,5.9,3,4.1,col="black",lwd=3)
arrows(7,4.1,7,5.9,col="black",lwd=3)
text(1.5,5,"EXP. DESIGN (1)",col="black",cex=1.2)
text(8.5,5,"ESTIMATION &\nINFERENCE (3)",col="black",cex=1.2)
text(7.5,.5,"DATA EXPLORATION &\nDESCRIPTIVE STATISTICS (2)",col="black",cex=1.2)
```
