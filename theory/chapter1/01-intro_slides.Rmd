---
title: "Introductie: Waarom Statistiek?"
author: Lieven Clement
output: ioslides_presentation
---

# Met statistiek kan je alles bewijzen

---

# Met foute statistiek kan je alles bewijzen

---

Garcia-Berthou & Alcaraz (Med. Res. Meth. 2004):

- Jaargang 2001 van Nature en British Medical Journal
- 38% en 25% van artikelen bevat een statistische fout
- 11%: fouten tegen interpretatie
- 4%: besluit spreekt evidentie tegen

---

Fonseca et al. 2020 publiceerden een pre-print waarin ze de associatie tussen consumptie van groeten en covid mortaliteit onderzoeken. (paper is nog niet aanvaard door een tijdschrift)
https://www.medrxiv.org/content/10.1101/2020.07.17.20155846v1



---

![](https://github.com/statOmics/sbc20/raw/master/theory/figures/pnasHumanMousePaperTitle.png){width=95%}

"the expression for many sets of genes was found to be more similar in different tissues within the same species than between species."

"Overall, our results indicate that there is considerable RNA expression diversity between humans and mice, well beyond what was described previously, likely reflecting the fundamental physiological differences between these two organisms."

---

![](https://pbs.twimg.com/media/CDsSzcUVAAAVXsk?format=png&name=900x900)
https://twitter.com/Y_Gilad/status/593088451462963202

---

![](https://pbs.twimg.com/media/CDsSzcFUMAAVwGa?format=png&name=small)
https://twitter.com/Y_Gilad/status/593088451462963202

---



---

## Oksel microbiome voorbeeld

![](https://images.vrt.be/width1280/2018/06/27/4e72098d-7a0d-11e8-abcc-02b7b76bf47f.jpg){width=70%}

- https://www.vrt.be/vrtnws/nl/2018/10/22/gezocht-mensen-met-penetrante-lijfgeur-om-probiotische-deodor/
- https://youtu.be/9RIFyqLXdVw

```{r echo=FALSE}
library(tidyverse)
```

---

- *Corynebacterium spp.* metaboliseren zweet en produceren verzadigde vetzuren met een penetrante geur.

- *Staphylococcus spp.* metaboliseren zweet ook maar produceren geen hinderlijke vetzuren.

- De CMET-groep aan UGENT doet onderzoek naar het transplanteren van de microbiële gemeenschap, het microbiome, om mensen van geurende oksels af te helpen.

- Voorgestelde therapie

  	1. Verwijder het oksel microbiome met antibiotica
    2. Beïnvloed het oksel microbiome door microbiome te transplanteren van een individue die geen geurende oksels heeft

---

Experiment?

```{r out.width='80%',fig.asp=.8, fig.align='center',echo=FALSE}
if ("pi"%in%ls()) rm("pi")
kopvoeter<-function(x,y,angle=0,l=.2,cex.dot=.5,pch=19,col="black")
{
angle=angle/180*pi
points(x,y,cex=cex.dot,pch=pch,col=col)
lines(c(x,x+l*cos(-pi/2+angle)),c(y,y+l*sin(-pi/2+angle)),col=col)
lines(c(x+l/2*cos(-pi/2+angle),x+l/2*cos(-pi/2+angle)+l/4*cos(angle)),c(y+l/2*sin(-pi/2+angle),y+l/2*sin(-pi/2+angle)+l/4*sin(angle)),col=col)
lines(c(x+l/2*cos(-pi/2+angle),x+l/2*cos(-pi/2+angle)+l/4*cos(pi+angle)),c(y+l/2*sin(-pi/2+angle),y+l/2*sin(-pi/2+angle)+l/4*sin(pi+angle)),col=col)
lines(c(x+l*cos(-pi/2+angle),x+l*cos(-pi/2+angle)+l/2*cos(-pi/2+pi/4+angle)),c(y+l*sin(-pi/2+angle),y+l*sin(-pi/2+angle)+l/2*sin(-pi/2+pi/4+angle)),col=col)
lines(c(x+l*cos(-pi/2+angle),x+l*cos(-pi/2+angle)+l/2*cos(-pi/2-pi/4+angle)),c(y+l*sin(-pi/2+angle),y+l*sin(-pi/2+angle)+l/2*sin(-pi/2-pi/4+angle)),col=col)
}

par(mar=c(0,0,0,0),mai=c(0,0,0,0))
plot(0,0,xlab="",ylab="",xlim=c(0,10),ylim=c(0,10),col=0,xaxt="none",yaxt="none",axes=FALSE)
rect(0,6,10,10,border="red",lwd=2)
text(.5,8,"population",srt=90,col="red",cex=2)
symbols (3, 8, circles=1.5, col="red",add=TRUE,fg="red",inches=FALSE,lwd=2)
set.seed(330)
grid=seq(0,1.3,.01)

for (i in 1:50)
{
	angle1=runif(n=1,min=0,max=360)
	angle2=runif(n=1,min=0,max=360)
	radius=sample(grid,prob=grid^2*pi/sum(grid^2*pi),size=1)
	kopvoeter(3+radius*cos(angle1/180*pi),8+radius*sin(angle1/180*pi),angle=angle2)
}
text(7.5,8,"Microbiome in population",col="red",cex=1.2)
```

---

Experiment?

```{r out.width='80%',fig.asp=.8, fig.align='center',echo=FALSE}
if ("pi"%in%ls()) rm("pi")
kopvoeter<-function(x,y,angle=0,l=.2,cex.dot=.5,pch=19,col="black")
{
angle=angle/180*pi
points(x,y,cex=cex.dot,pch=pch,col=col)
lines(c(x,x+l*cos(-pi/2+angle)),c(y,y+l*sin(-pi/2+angle)),col=col)
lines(c(x+l/2*cos(-pi/2+angle),x+l/2*cos(-pi/2+angle)+l/4*cos(angle)),c(y+l/2*sin(-pi/2+angle),y+l/2*sin(-pi/2+angle)+l/4*sin(angle)),col=col)
lines(c(x+l/2*cos(-pi/2+angle),x+l/2*cos(-pi/2+angle)+l/4*cos(pi+angle)),c(y+l/2*sin(-pi/2+angle),y+l/2*sin(-pi/2+angle)+l/4*sin(pi+angle)),col=col)
lines(c(x+l*cos(-pi/2+angle),x+l*cos(-pi/2+angle)+l/2*cos(-pi/2+pi/4+angle)),c(y+l*sin(-pi/2+angle),y+l*sin(-pi/2+angle)+l/2*sin(-pi/2+pi/4+angle)),col=col)
lines(c(x+l*cos(-pi/2+angle),x+l*cos(-pi/2+angle)+l/2*cos(-pi/2-pi/4+angle)),c(y+l*sin(-pi/2+angle),y+l*sin(-pi/2+angle)+l/2*sin(-pi/2-pi/4+angle)),col=col)
}

par(mar=c(0,0,0,0),mai=c(0,0,0,0))
plot(0,0,xlab="",ylab="",xlim=c(0,10),ylim=c(0,10),col=0,xaxt="none",yaxt="none",axes=FALSE)
rect(0,6,10,10,border="red",lwd=2)
text(.5,8,"population",srt=90,col="red",cex=2)
symbols (3, 8, circles=1.5, col="red",add=TRUE,fg="red",inches=FALSE,lwd=2)
set.seed(330)
grid=seq(0,1.3,.01)

for (i in 1:50)
{
	angle1=runif(n=1,min=0,max=360)
	angle2=runif(n=1,min=0,max=360)
	radius=sample(grid,prob=grid^2*pi/sum(grid^2*pi),size=1)
	kopvoeter(3+radius*cos(angle1/180*pi),8+radius*sin(angle1/180*pi),angle=angle2)
}
text(7.5,8,"Microbiome in population",col="red",cex=1.2)

rect(0,0,10,4,border="blue",lwd=2)
text(.5,2,"sample",srt=90,col="blue",cex=2)
symbols (3, 2, circles=1.5, col="red",add=TRUE,fg="blue",inches=FALSE,lwd=2)
for (i in 0:1)
	for (j in 0:4)
{

	kopvoeter(2.1+j*(3.9-2.1)/4,1.1+i/2,col="black")
}
for (i in 2:3)
	for (j in 0:4)
{

	kopvoeter(2.1+j*(3.9-2.1)/4,1.6+i/2,col="black")
}
text(7.5,2,"Microbiome in sample",col="blue",cex=1.2)

arrows(3,5.9,3,4.1,col="black",lwd=3)
text(1.5,5,"EXP. DESIGN (1)",col="black",cex=1.2)
```

---


- Experiment:

    - 20 personen met okselgeur worden at random in twee behandelingsgroepen ingedeeld:

        - placebo (enkel antibiotica)
        - transplantie (antibiotica en microbiële transplantatie).

    - Het microbiome wordt bemonsterd 6 weken na de behandeling.
    - The relative abundantie van *Staphylococcus spp.* op *Corynebacterium spp.* + *Staphylococcus spp.* in het microbiome wordt gemeten via DGGE (*Denaturing Gradient Gel Electrophoresis*).

##DGGE

![](https://journals.plos.org/plosone/article/figure/image?size=large&download=&id=10.1371/journal.pone.0070538.g001){width=70%}

https://doi.org/10.1371/journal.pone.0070538

#Vertaal onderzoeksvraag in : Is er gemiddeld een verschil in relatieve abundantie van *Staphylococcus spp.* in het microbiome van de placebo en de transplantatie groep

---

Experiment?

```{r out.width='80%',fig.asp=.8, fig.align='center',echo=FALSE}
if ("pi"%in%ls()) rm("pi")
kopvoeter<-function(x,y,angle=0,l=.2,cex.dot=.5,pch=19,col="black")
{
angle=angle/180*pi
points(x,y,cex=cex.dot,pch=pch,col=col)
lines(c(x,x+l*cos(-pi/2+angle)),c(y,y+l*sin(-pi/2+angle)),col=col)
lines(c(x+l/2*cos(-pi/2+angle),x+l/2*cos(-pi/2+angle)+l/4*cos(angle)),c(y+l/2*sin(-pi/2+angle),y+l/2*sin(-pi/2+angle)+l/4*sin(angle)),col=col)
lines(c(x+l/2*cos(-pi/2+angle),x+l/2*cos(-pi/2+angle)+l/4*cos(pi+angle)),c(y+l/2*sin(-pi/2+angle),y+l/2*sin(-pi/2+angle)+l/4*sin(pi+angle)),col=col)
lines(c(x+l*cos(-pi/2+angle),x+l*cos(-pi/2+angle)+l/2*cos(-pi/2+pi/4+angle)),c(y+l*sin(-pi/2+angle),y+l*sin(-pi/2+angle)+l/2*sin(-pi/2+pi/4+angle)),col=col)
lines(c(x+l*cos(-pi/2+angle),x+l*cos(-pi/2+angle)+l/2*cos(-pi/2-pi/4+angle)),c(y+l*sin(-pi/2+angle),y+l*sin(-pi/2+angle)+l/2*sin(-pi/2-pi/4+angle)),col=col)
}

par(mar=c(0,0,0,0),mai=c(0,0,0,0))
plot(0,0,xlab="",ylab="",xlim=c(0,10),ylim=c(0,10),col=0,xaxt="none",yaxt="none",axes=FALSE)
rect(0,6,10,10,border="red",lwd=2)
text(.5,8,"population",srt=90,col="red",cex=2)
symbols (3, 8, circles=1.5, col="red",add=TRUE,fg="red",inches=FALSE,lwd=2)
set.seed(330)
grid=seq(0,1.3,.01)

for (i in 1:50)
{
	angle1=runif(n=1,min=0,max=360)
	angle2=runif(n=1,min=0,max=360)
	radius=sample(grid,prob=grid^2*pi/sum(grid^2*pi),size=1)
	kopvoeter(3+radius*cos(angle1/180*pi),8+radius*sin(angle1/180*pi),angle=angle2)
}
text(7.5,8,"Microbiome in population",col="red",cex=1.2)

rect(0,0,10,4,border="blue",lwd=2)
text(.5,2,"sample",srt=90,col="blue",cex=2)
symbols (3, 2, circles=1.5, col="red",add=TRUE,fg="blue",inches=FALSE,lwd=2)
for (i in 0:1)
	for (j in 0:4)
{

	kopvoeter(2.1+j*(3.9-2.1)/4,1.1+i/2,col="purple")
}
for (i in 2:3)
	for (j in 0:4)
{

	kopvoeter(2.1+j*(3.9-2.1)/4,1.6+i/2,col="orange")
}
text(7.5,2,"Microbiome in sample",col="blue",cex=1.2)

arrows(3,5.9,3,4.1,col="black",lwd=3)
text(1.5,5,"EXP. DESIGN (1)",col="black",cex=1.2)
text(7.5,.5,"DATA EXPLORATION &\nDESCRIPTIVE STATISTICS (2)",col="black",cex=1.2)
```

## Importeer de data

```{r echo=FALSE,message=FALSE}
ap <- read_csv("https://raw.githubusercontent.com/statOmics/sbc20/master/data/armpit.csv")
ap
```

---

### Beschrijvende statistiek

```{r echo=FALSE}
apRelSum <- ap %>%
  group_by(trt) %>%
  summarize_at("rel",
               list(mean=mean,
                    sd=sd
                    )
                )
knitr::kable(
  apRelSum %>%
  mutate_if(is.numeric, round, digits=1)
  )
```


---

#### Barplot

```{r echo=FALSE}
apRelSum%>%
  ggplot(aes(x=trt,y=mean)) +
  geom_bar(stat="identity") +
  geom_errorbar(aes(ymin=mean-sd,ymax=mean+sd),width=.2) +
  xlab("Behandeling")
```

- Is deze plot informatief??

---


```{r echo=FALSE}
ap %>%  
  ggplot(aes(x=trt,y=rel)) +
  geom_boxplot(outlier.shape=NA) +
  geom_point(position="jitter") +
  ylab("Relatieve abundantie (%)") +
  xlab("Behandeling")
```

Dit is een informatieve plot!

---

```{r out.width='80%',fig.asp=.8, fig.align='center',echo=FALSE}
if ("pi"%in%ls()) rm("pi")
kopvoeter<-function(x,y,angle=0,l=.2,cex.dot=.5,pch=19,col="black")
{
angle=angle/180*pi
points(x,y,cex=cex.dot,pch=pch,col=col)
lines(c(x,x+l*cos(-pi/2+angle)),c(y,y+l*sin(-pi/2+angle)),col=col)
lines(c(x+l/2*cos(-pi/2+angle),x+l/2*cos(-pi/2+angle)+l/4*cos(angle)),c(y+l/2*sin(-pi/2+angle),y+l/2*sin(-pi/2+angle)+l/4*sin(angle)),col=col)
lines(c(x+l/2*cos(-pi/2+angle),x+l/2*cos(-pi/2+angle)+l/4*cos(pi+angle)),c(y+l/2*sin(-pi/2+angle),y+l/2*sin(-pi/2+angle)+l/4*sin(pi+angle)),col=col)
lines(c(x+l*cos(-pi/2+angle),x+l*cos(-pi/2+angle)+l/2*cos(-pi/2+pi/4+angle)),c(y+l*sin(-pi/2+angle),y+l*sin(-pi/2+angle)+l/2*sin(-pi/2+pi/4+angle)),col=col)
lines(c(x+l*cos(-pi/2+angle),x+l*cos(-pi/2+angle)+l/2*cos(-pi/2-pi/4+angle)),c(y+l*sin(-pi/2+angle),y+l*sin(-pi/2+angle)+l/2*sin(-pi/2-pi/4+angle)),col=col)
}

par(mar=c(0,0,0,0),mai=c(0,0,0,0))
plot(0,0,xlab="",ylab="",xlim=c(0,10),ylim=c(0,10),col=0,xaxt="none",yaxt="none",axes=FALSE)
rect(0,6,10,10,border="red",lwd=2)
text(.5,8,"population",srt=90,col="red",cex=2)
symbols (3, 8, circles=1.5, col="red",add=TRUE,fg="red",inches=FALSE,lwd=2)
set.seed(330)
grid=seq(0,1.3,.01)

for (i in 1:50)
{
	angle1=runif(n=1,min=0,max=360)
	angle2=runif(n=1,min=0,max=360)
	radius=sample(grid,prob=grid^2*pi/sum(grid^2*pi),size=1)
	kopvoeter(3+radius*cos(angle1/180*pi),8+radius*sin(angle1/180*pi),angle=angle2)
}
text(7.5,8,"Microbiome in population",col="red",cex=1.2)

rect(0,0,10,4,border="blue",lwd=2)
text(.5,2,"sample",srt=90,col="blue",cex=2)
symbols (3, 2, circles=1.5, col="red",add=TRUE,fg="blue",inches=FALSE,lwd=2)
for (i in 0:1)
	for (j in 0:4)
{

	kopvoeter(2.1+j*(3.9-2.1)/4,1.1+i/2,col="purple")
}
for (i in 2:3)
	for (j in 0:4)
{

	kopvoeter(2.1+j*(3.9-2.1)/4,1.6+i/2,col="orange")
}
text(7.5,2,"Microbiome in sample",col="blue",cex=1.2)

arrows(3,5.9,3,4.1,col="black",lwd=3)
text(1.5,5,"EXP. DESIGN (1)",col="black",cex=1.2)
text(7.5,.5,"DATA EXPLORATION &\nDESCRIPTIVE STATISTICS (2)",col="black",cex=1.2)
arrows(7,4.1,7,5.9,col="black",lwd=3)
text(8.5,5,"ESTIMATION &\nINFERENCE (3)",col="black",cex=1.2)
```

---

- Falsificatie principe van Popper: Data kunnen enkel een hypothese of een theorie ontkrachten.

- Met statistiek kunnen we dus niet aantonen dat de behandeling werkt.

- Statistiek zal ons wel toelaten om het omgekeerde te falsifiëren:
wat is de kans om een gemiddeld verschil in relatieve abundantie te zien tussen placebo en transplantatiegroep die minstens zo groot is als in de steekproef door toeval, m.a.w. als de behandeling geen effect heeft.

- Die kans wordt een p-waarde genoemd.

- Als p heel klein is, dan is het heel onwaarschijnlijk om een dergelijk effect te observeren door toeval.

- Om deze kans te berekenen is het nodig om de data te modelleren met statistische modellen.

---


T-test

```{r}
ap %>% t.test(rel~trt,data=.)
```

Conclusie:
Gemiddeld is de relatieve abundantie van Staphylococcus in het microbiome van personen met een zweetgeur `r format(apRelSum$mean[2]-apRelSum$mean[1],digits=3)`% hoger na de transplantie dan na de placebo behandeling.

---

# Variabiliteit van steekproef tot steekproef

---

- Randomisatie sterk gerelateerd met het concept van de populatie en scope van de studie.  

- De scope van de studie moet goed worden omschreven voor de start van het experiment.

- Om resultaten van de steekproef te kunnen veralgemenen naar de populatie toe  $\rightarrow$ trek subjecten at random uit de populatie

---

- Volledig random trekken van de populatie :

    - alle subjecten van de populatie hebben evenveel kans om in de steekproef te worden opgenomen.

    - selectie van een subject is onafhankelijk van andere subjecten in de steekproef.

- De steekproef is dan representatief voor de populatie, maar is nog steeds random.

- Wat betekent dit?

---

- Om dit te illustreren zullen we gebruik maken van een hele grote studie.

- Uit die studie zullen we herhaaldelijk kleine steekproeven trekken om te begrijpen hoe de gegevens en statistieken veranderen van steekproef tot steekproef.

---


```{r}
library(NHANES)
glimpse(NHANES)
```

---

Onderzoeksvraag: hoe verschilt de lengte van volwassen mannen en vrouwen.

---

Onderzoeksvraag: hoe verschilt de lengte van volwassen mannen en vrouwen.

```{r echo=FALSE, warning=FALSE, message=FALSE}
NHANES%>%  
  filter(Age>18&!is.na(Height)) %>%
  ggplot(aes(x=Height))+
  geom_histogram() +
  facet_grid(Gender~.) +
  xlab("Lengte (cm)")
```

---


- Approximatief Normaal Verdeeld
- Normale verdeling heeft maar 2 parameters: het gemiddelde en de variantie (maat voor spreiding).
- Laat toe om de data verder samen te vatten d.m.v. twee statistieken:

    - gemiddelde
    - standaard deviatie

```{r echo=FALSE}
nhanesSub<- NHANES%>%
  filter(Age>25&!is.na(Height)) %>%
  select(c("Gender","Height"))

HeightSum <- nhanesSub %>%
  group_by(Gender) %>%
  summarize_at("Height",
               list(mean=mean,
               sd=sd)
              )

knitr::kable(
  HeightSum %>%
  mutate_if(is.numeric, round, digits=1)
  )
```

---


- Stel dat we geen toegang hebben tot de metingen van de NHANES studie.

- We zouden dan een experiment op moeten zetten om metingen bij mannen en vrouwen te doen.

- Veronderstel dat we budget hebben om metingen bij 5 mannen en 5 vrouwen te doen.

- We zouden dan 5 mannen en 5 vrouwen boven de 25 jaar at random selecteren uit de Amerikaanse populatie.

- We kunnen dit experiment simuleren door 5 vrouwen en 5 mannen at random te selecteren uit de NHANES studie.

---

```{r echo=FALSE}
set.seed(1000001)
nSamp <- 5
fem <- nhanesSub %>%
  filter(Gender=="female") %>%
  sample_n(size=5)

mal <- nhanesSub %>%
  filter(Gender=="male") %>%
  sample_n(size=5)

samp1 <- rbind(fem,mal)
```

```{r}
samp1
```

---

Data Exploratie


```{r echo=FALSE}
samp1 %>%
  ggplot(aes(x=Gender,y=Height)) +
  geom_boxplot(outlier.shape=NA) +
  geom_point(position="jitter") +
  geom_point(aes(x=1,y=mean(fem$Height)),size=3,pch=17,color="darkred") +
  geom_point(aes(x=2,y=mean(mal$Height)),size=3,pch=17,color="darkred") +
  ylab("Height (cm)")
```

Vrouwen zijn gemiddeld `r round(abs(HeightSumExp1$mean[1]-HeightSumExp1$mean[2]),2)` cm `r ifelse(HeightSumExp1$mean[1]>HeightSumExp1$mean[2],"groter","kleiner")` dan mannen. En dit verschil is statistisch `r ifelse(t.test(Height~Gender,samp1,var.equal=TRUE)$p.value < 0.05,"significant","niet significant")`

---

Herhaal experiment: Nieuwe steekproef

```{r echo=FALSE}
fem <- nhanesSub %>%
  filter(Gender=="female") %>%
  sample_n(size=5)

mal <- nhanesSub %>%
  filter(Gender=="male") %>%
  sample_n(size=5)

samp2 <- rbind(fem,mal)

samp2 %>%
  ggplot(aes(x=Gender,y=Height)) +
  geom_boxplot(outlier.shape=NA) +
  geom_point(position="jitter") +
  geom_point(aes(x=1,y=mean(fem$Height)),size=3,pch=17,color="darkred") +
  geom_point(aes(x=2,y=mean(mal$Height)),size=3,pch=17,color="darkred") +
  ylab("Lengte (cm)")

  HeightSumExp2 <- samp2 %>%
     group_by(Gender) %>%
     summarize_at("Height",
                 list(mean=mean,
                      sd=sd)
                  )
```


Vrouwen zijn gemiddeld `r round(abs(HeightSumExp2$mean[1]-HeightSumExp2$mean[2]),2)` cm `r ifelse(HeightSumExp2$mean[1]>HeightSumExp2$mean[2],"groter","kleiner")` dan mannen. En dit verschil is statistisch `r ifelse(t.test(Height~Gender,samp2,var.equal=TRUE)$p.value < 0.05,"significant","niet significant")`

---

Herhaal experiment: Nieuwe steekproef

```{r echo=FALSE}
seed <- 1336602
set.seed(seed)
fem <- nhanesSub%>%filter(Gender=="female")%>%sample_n(size=5)
mal <- nhanesSub%>%filter(Gender=="male")%>%sample_n(size=5)

samp3<-rbind(fem,mal)

samp3%>%
  ggplot(aes(x=Gender,y=Height)) +
  geom_boxplot(outlier.shape=NA) +
  geom_point(position="jitter") +
  ylab("Lengte (cm)")

HeightSumExp3 <- samp3 %>%
  group_by(Gender) %>%
  summarize_at("Height",
                   list(mean=mean,
                        sd=sd)
                    )
```


Vrouwen zijn gemiddeld `r round(abs(HeightSumExp3$mean[1]-HeightSumExp3$mean[2]),2)` cm `r ifelse(HeightSumExp3$mean[1]>HeightSumExp3$mean[2],"groter","kleiner")` dan mannen. En dit verschil is statistisch `r ifelse(t.test(Height~Gender,samp3,var.equal=TRUE)$p.value < 0.05,"significant","niet significant")`

## Samenvatting

- At random andere proefpersonen in elke steekproef

- Hierdoor verschillen lengte metingen van steekproef tot steekproef.

- Dus ook het geschatte gemiddeldes en standaard deviaties.

- Ook onze conclusies zijn onzeker en kunnen wijzigen van steekproef tot steekproef.

- Steekproeven waarbij het effect tegengesteld is aan dat in de populatie en waarbij we besluiten dat het verschil significant is, zijn zeldzaam.

$\rightarrow$ Met statistiek controleren we de kans op het trekken foute conclusies.

## We illusteren dit door repeated sampling

```{r echo=FALSE}
# Aantal simulaties en steekproefgrootte per groep
nSim <- 10000
nSamp <- 5

# We filteren de data vooraf zodat we dit niet telkens opnieuw hoeven te doen
fem<-nhanesSub %>%
  filter(Gender=="female")

mal <- nhanesSub %>%
  filter(Gender=="male")

# Simulatie studie
# Om snelle functies te kunnen gebruiken nemen we eerst nSim steekproeven en berekenen we daarna alles.

femSamps <- malSamps <-matrix(NA,nrow=nSamp,ncol=nSim)
for (i in 1:nSim)
{
  femSamps[,i] <- sample(fem$Height,nSamp)
  malSamps[,i] <- sample(mal$Height,nSamp)
}

res <- data.frame(
  verschil=colMeans(femSamps) - colMeans(malSamps),
  Rfast::ttests(femSamps,malSamps)
  )
```

Op basis van 10 000 steekproeven van 5 mannen en 5 vrouwen:


- Aantal steekproeven waarvoor vrouwen gemiddeld significant kleiner zijn dan mannen: `r sum(res$pvalue<0.05&res$verschil<0)`

- Aantal steekproeven waarvoor vrouwen en mannen gemiddeld niet significant verschillen in lengte: `r sum(res$pvalue>=0.05)`

- Aantal steekproeven waarvoor vrouwen gemiddeld significant groter zijn dan mannen: `r sum(res$pvalue<0.05&res$verschil>0)`

- Ik had `r paste(seed)` steekproeven moeten trekken om de extreme steekproef te vinden waaruit we foutief zouden concluderen dat vrouwen gemiddeld significant groter zijn dan mannen.

---

```{r echo=FALSE}
res %>%
  ggplot(aes(x=verschil,y=-log10(pvalue),color=pvalue<0.05)) +
  geom_point() +
  xlab("gemiddeld verschil (cm)") +
  ylab("Statistische Significantie (- log10 p)") +
  geom_vline(aes(xintercept=0)) +
  geom_vline(aes(xintercept=mean(fem$Height)-mean(mal$Height)),color="darkred")
```

## Grotere steekproef: 50 subjecten per groep?

```{r echo=FALSE}
nSim <- 10000
nSamp <- 50

# We filteren de data vooraf zodat we dit niet telkens opnieuw hoeven te doen
fem<-nhanesSub%>%filter(Gender=="female")
mal<-nhanesSub%>%filter(Gender=="male")

# Simulatie studie
# Om snelle functies te kunnen gebruiken nemen we eerst nSim steekproeven en berekenen we daarna alles.

femSamps <- malSamps <-matrix(NA,nrow=nSamp,ncol=nSim)
for (i in 1:nSim)
{
  femSamps[,i] <- sample(fem$Height,nSamp)
  malSamps[,i] <- sample(mal$Height,nSamp)
}

res50 <- data.frame(
  verschil=colMeans(femSamps) - rowMeans(malSamps),
  Rfast::ttests(femSamps,malSamps)
  )
```

```{r echo=FALSE}
res %>%
  ggplot(aes(x=verschil,y=-log10(pvalue),color=pvalue<0.05)) +
  geom_point() +
  xlab("gemiddeld verschil (cm)") +
  ylab("Statistische Significantie (- log10 p)") +
  geom_vline(aes(xintercept=0)) +
  geom_vline(aes(xintercept=mean(fem$Height)-mean(mal$Height)),color="darkblue") +
  ggtitle("5 subjecten per groep") +
  ylim(0,max(-log10(res50$pvalue)))
```

## Grotere steekproef: 50 subjecten per groep

```{r echo=FALSE}
res50 %>%
  ggplot(aes(x=verschil,y=-log10(pvalue),color=pvalue<0.05)) +
  geom_point() +
  xlab("gemiddeld verschil (cm)") +
  ylab("Statistische Significantie (- log10 p)") +
  geom_vline(aes(xintercept=0)) +
  geom_vline(aes(xintercept=mean(fem$Height)-mean(mal$Height)),color="darkblue") +
  ggtitle("50 subjecten per groep") +
  xlim(min(res$verschil),max(res$verschil)) +
  ylim(0,max(-log10(res50$pvalue)))
```


---

## Salk Study

- In 1916, brak de eerste grote polio epidemie uit in de USA.
- Begin de jaren 50 ontwikkelde John Salk een vaccin met belovende resultaten in het lab.
- In 1954, heeft de National Foundation
for Infantile Paralysis (NFIP) een grote studie opgezet om de effectiviteit van het Salk vaccin na te gaan.
- Veronderstel dat de NFIP in 1954 een groot aantal kinderen zou hebben gevaccineerd, wat zouden ze dan kunnen besluiten als de polio incidentie in 1954 lager was dan in 1953?


## NFIP Study
### Design

- Grote simultane studie met gevaccineerde kinderen (cases) en ongevaccineerde kinderen (controles).
- In scholen van districten met hoge polio incidentie.
- Cases: kinderen van de tweede graad van het lager onderwijs waarvan de ouders toestemden met vaccinatie.
- Controles: kinderen van de eerste en derde graad.

---

### Data
```{r echo=FALSE}
nfip <- tibble(
  group=c("cases","controls","noConcent"),
  grade=c("g2","g1g3","g2"),
  vaccin=c("yes","no","no"),
  total=c(221998,725173,123605),
  polio=c(54,391,56)
  ) %>%
  mutate(noPolio = total - polio)
knitr::kable(nfip)
```

Vergelijk de polio incidentie?

---

### Data
```{r echo=FALSE}
nfip <- nfip %>%
  mutate(incidencePM = round(nfip$polio/nfip$total*1e6,0))
knitr::kable(nfip)
```

Wat kunnen we concluderen?


## Confounding


```{r,echo=FALSE, fig.align = "center",out.width = '50%'}
plot(c(0,0,1),c(-2,2,0),pch=c("S","V","P"),xaxt="none",yaxt="none",axes=FALSE,xlab="",ylab="",cex=4,ylim=c(-2.2,2.2))
arrows(x0=0.1,x1=.9,y0=1.8,y1=0.1,lwd=4)
arrows(x0=0.1,x1=.9,y0=-1.8,y1=-0.2,lwd=4)
arrows(x0=0,x1=0,y0=-1.4,y1=1.4,lwd=4)
```


- We observeren een lagere polio (P) incidentie voor kinderen bij wie de ouders geen toestemming gaven dan in de controle groep.  

- Toestemming voor vaccinatie (V) is geassocieerd met de socio-economische status (S).

- Kinderen van lagere socio-economische status zijn meer resistent tegen de ziekte.

## Confounding

- De groepen van cases en controles zijn niet vergelijkbaar
    - verschil in leeftijd
    - verschil in socio-economische status en
    - verschil in vatbaarheid voor de ziekte.

## Salk Study

### Design
Een nieuwe studie werd uitgevoerd: dubbel blinde gerandomiseerde studie.

  - Kinderen worden at random toegewezen aan controle of case arm van het experiment nadat de ouders toestemden met vaccinatie.
  - Controle: vaccinatie met placebo
  - Treatment: vaccinatie met vaccine
  - Double blinding:
    - ouders en kinderen weten niet of ze werden gevaccineerd of niet
    - medische staf en onderzoekers weten niet of het kind het vaccin of de placebo kreeg

---

### Data

```{r echo=FALSE}
salk <- data.frame(
  group=c("cases","control","noConcent"),
  treatment=c("vaccine","placebo","none"),
  total=c(200745,201229, 338778),polio=c(57,142,157)
  ) %>%
  mutate(
    noPolio = total-polio,
    incidencePM = round(polio/total*1e6,0)
    )
knitr::kable(salk)
```

- We observeren een veel groter effect nu dat cases en controles vergelijkbaar zijn, incidentie van respectievelijk `r salk$incidencePM[1]`  and `r salk$incidencePM[2]` per miljoen.

- De polio incidentie voor kinderen die geen toestemming geven blijft vergelijkbaar  `r nfip$incidencePM[3]` and `r salk$incidencePM[3]` per miljoen respectievelijk in the NFIP and Salk study.


## Rol van Statistiek
- We hebben gezien dat
    - het belangrijk is om de scope van de studie goed te specifiëren voor de start van het experiment.
    - de proefpersonen at random moeten worden getrokken uit de populatie.
    - steekproef grootte is heel belangrijk
    - we moeten ons bewust zijn van Confounding
    - een goede controle is belangrijk


$\rightarrow$ Goede proefopzet is cruciaal!

---

- We hebben ook geobserveerd dat er variabiliteit is in de populatie
- We kunnen maar een steekproef nemen uit de populatie

$\rightarrow$ onzekerheid in de resultaten

$\rightarrow$ onzekerheid in de conclusies


---

- Statistiek is de wetenschap voor het

    1. verzamelen (experimenteel design),
    2. exploren (data exploration) en
    3. leren van data zodat we hetgeen we observeren in de steekproef kunnen veralgemenen naar de populatie terwijl we de onzekerheid quantificeren, controleren en rapporteren (statistisch modelleren en statistische besluitvorming).

- Statistiek speelt daarom een heel belangrijke rol in zowat alle wetenschappen
